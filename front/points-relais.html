<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mondial Relay Parcelshop Picker avec carte</title>

    <!-- Inclusion de JQuery (version 3.6.0) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- Inclusion de Leaflet (bibliothèque pour la carte) -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <!-- Inclusion du plugin Mondial Relay Parcelshop Picker -->
    <script src="https://widget.mondialrelay.com/parcelshop-picker/jquery.plugin.mondialrelay.parcelshoppicker.min.js"></script>

    <style>
        /* Style pour la carte */
        #Zone_Widget {
            width: 100%;
            height: 500px;
        }

        /* Input pour afficher le point relais sélectionné (caché en production) */
        #Target_Widget {
            display: none;
        }
    </style>
</head>

<body>

    <!-- Élément où le widget du sélectionneur de points relais sera chargé -->
    <div id="Zone_Widget"></div>

    <!-- Élément pour afficher le point relais sélectionné -->
    <input type="text" id="Target_Widget" />

    <script>
        // Initialisation du widget après le chargement complet de la page
        $(window).on('load', function () {
            try {
                // Vérification de la présence des éléments DOM
                if ($('#Zone_Widget').length && $('#Target_Widget').length) {
                    // Initialisation du widget Mondial Relay dans la div #Zone_Widget avec les paramètres spécifiés
                    $("#Zone_Widget").MR_ParcelShopPicker({
                        // Paramètres pour afficher les résultats dans l'input cible
                        Target: "#Target_Widget",

                        // Paramètres pour l'accès aux données des points relais
                        Brand: "CC23FE9J",  // Code Mondial Relay ici
                        Country: "FR",  // Pays par défaut (ici la France)
                        PostCode: "59000",  // Code postal par défaut
                        ColLivMod: "24R",  // Mode de livraison par défaut (Standard)
                        NbResults: "7",  // Nombre de résultats à afficher (max 20)

                        // Paramètres d'affichage
                        Responsive: true,  // Rendre le widget responsive
                        ShowResultsOnMap: true  // Afficher les résultats sur une carte avec OpenStreetMap
                    });

                    // Ajouter un délai pour réinitialiser le widget si l'erreur persiste
                    setTimeout(function() {
                        if (typeof $.fn.MR_ParcelShopPicker !== 'undefined') {
                            $("#Zone_Widget").MR_ParcelShopPicker("refresh");
                        }
                    }, 2000);  // Attente de 2 secondes avant de rafraîchir
                } else {
                    console.error('Les éléments DOM nécessaires ne sont pas présents.');
                }
            } catch (e) {
                console.error("Erreur d'initialisation du widget Mondial Relay : ", e);
            }
        });
    </script>

</body>

</html>
